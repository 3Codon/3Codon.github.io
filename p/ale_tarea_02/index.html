<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="Practical Activity"><title>Practical alignment</title>
<link rel=canonical href=https://3codon.github.io/p/ale_tarea_02/><link rel=stylesheet href=/scss/style.min.663803bebe609202d5b39d848f2d7c2dc8b598a2d879efa079fa88893d29c49c.css><meta property='og:title' content="Practical alignment"><meta property='og:description' content="Practical Activity"><meta property='og:url' content='https://3codon.github.io/p/ale_tarea_02/'><meta property='og:site_name' content='3Codon'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='BWA'><meta property='article:tag' content='Alignment'><meta property='article:tag' content='QC'><meta property='article:tag' content='FASTQC'><meta property='article:tag' content='QUALITY CONTROLL'><meta property='article:published_time' content='2025-02-11T00:00:00+00:00'><meta property='article:modified_time' content='2025-02-11T00:00:00+00:00'><meta property='og:image' content='https://3codon.github.io/p/ale_tarea_02/cover.jpg'><meta name=twitter:title content="Practical alignment"><meta name=twitter:description content="Practical Activity"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content='https://3codon.github.io/p/ale_tarea_02/cover.jpg'><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label="Toggle Menu">
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_c229b8af19874e71.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>üêà‚Äç‚¨õ</span></figure><div class=site-meta><h1 class=site-name><a href=/>3Codon</a></h1><h2 class=site-description>Looking for a bright future, and past in paleo case.</h2></div></header><ol class=menu-social><li><a href=https://github.com/3Codon target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>Dark Mode</span></li></ol></li></ol></aside><main class="main full-width"><article class="has-image main-article"><header class=article-header><div class=article-image><a href=/p/ale_tarea_02/><img src=/p/ale_tarea_02/cover_hu_9de4b20375085e72.jpg srcset="/p/ale_tarea_02/cover_hu_9de4b20375085e72.jpg 800w, /p/ale_tarea_02/cover_hu_364b97e585c75633.jpg 1600w" width=800 height=450 loading=lazy alt="Featured image of post Practical alignment"></a></div><div class=article-details><header class=article-category><a href=/categories/activity/>Activity
</a><a href=/categories/bioinformatics/>Bioinformatics
</a><a href=/categories/basic/>Basic</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/ale_tarea_02/>Practical alignment</a></h2><h3 class=article-subtitle>Practical Activity</h3></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Feb 11, 2025</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>12 minute read</time></div></footer></div></header><section class=article-content><div id=using-bwa-index-de-e.-coli-genome class="section level2"><h2>‚Ä¢ Using bwa index de e. coli genome</h2><p>a
<strong>Suazo:</strong></p><pre class=bash><code>module load bwa/0.7.17

bwm index Escherichia_coli_K12_MG1655.fasta</code></pre><p>This would create multiple files</p><div class=table-wrapper><table><col width=50%><col width=50%><thead><tr class=header><th>Archive</th><th>Description</th></tr></thead><tbody><tr class=odd><td>.amb</td><td>Contain Infromation about ambigous bases (N) in the sequence.</td></tr><tr class=even><td>.ann</td><td>Contain Annotation about genome, like sequences names and lenghts.</td></tr><tr class=odd><td>.bwt</td><td>Contain compressed representation of the genome using Burrows-Wheeler algorithm.</td></tr><tr class=even><td>.pac</td><td>Contain packed genome sequence in 2 bits per base. It is used to search the genome.</td></tr><tr class=odd><td>.sa</td><td>Contain the suffix array of the genome.</td></tr></tbody></table></div></div><div id=align-reads-from-a-fnr-chip-seq-experiment class="section level2"><h2>‚Ä¢ Align reads from a FNR ChIP-seq experiment</h2><p><strong>Suazo:</strong></p><pre class=bash><code>bwa mem Escherichia_coli_K12_MG1655.fasta SRX189773_FNR_ChIP.fastq </code></pre><p>This will generate a SAM file with the alignment of the reads to the genome.</p><blockquote><p>Preview:</p></blockquote><pre class=bash><code>@SQ	SN:NC_000913.2	LN:4639675
@PG	ID:bwa	PN:bwa	VN:0.7.17-r1188	CL:bwa mem Escherichia_coli_K12_MG1655.fasta SRX189773_FNR_ChIP.fastq
SRR576933.1	0	NC_000913.2	914875	60	36M	*	0	0	AAGCATGGAATAACCGCCTGGTGAATGCTCGCCATA EDEA=EEEEEBFBDFDEBDAD=DDBAC5CCEEE:E@	NM:i:0	MD:Z:36	AS:i:36	XS:i:0
SRR576933.2	0	NC_000913.2	147284	60	36M	*	0	0	TGGAGGCTGACCACGATAAGCTGCCGCTGGTGGTGC	EDF:D?=DEEE?EEE5DDDAEB:ECEBBEA&gt;AA956	NM:i:0	MD:Z:36	AS:i:36	XS:i:0
SRR576933.3	0	NC_000913.2	1572373	60	36M	*	0	0	AGTGCGATGCCGTTCACCCGGTTTTCTTTATCATTA	EEEEED=DD?AD=DDEEBEDEBBECCD&gt;&gt;&gt;BB?EE5	NM:i:0	MD:Z:36	AS:i:36	XS:i:0
</code></pre></div><div id=using-the-available-indexed-genomes-in-the-cluster-mntarchivesgenome-align-reads-of-a-mouse-chip-seq-experiment-to-the-genome. class="section level2"><h2>‚Ä¢ Using the available indexed genomes in the cluster (/mnt/Archives/genome/) align reads of a mouse ChIP-seq experiment to the genome.</h2><blockquote><p>‚Ä¢ Please analyze the quality of the data, try using fastqc ;)</p></blockquote><blockquote><p>Here you go, <a href=https://3lconejo.github.io/posts/fastqc/>fastqc</a></p></blockquote><p><strong>Ferro</strong>:
What is FASTQC?</p><p>One of the essential steps in research on the molecule of life is its sequencing. Once the samples have been extracted, the sequencing process is carried out to obtain the nucleotide sequence of the samples. Currently, the new sequencing technology ‚Äú‚Ä¶can generate hundreds of thousands of sequences in a single run.‚Äù (Babraham institute). But it should be mentioned that before doing an analysis of the sequences to reach a conclusion, it is important to do a simple quality control on the fastq files, to observe how well the raw files look for future analysis and thus avoid biases that can affect the research.</p><p>To do quality tests for fastq files, there is the <strong>FASTQC</strong> tool, whose output is a report of the problems that arose in the sequencer or in the start library.This tool can be run in two different modes, the first is as a stand-alone interactive application that can perform a quick analysis with a few fastq files or as a non-interactive mode, where the analysis process is larger, since it does
a ‚Äú‚Ä¶systematic processing of large amounts of files.‚Äù (Babraham institute)</p><p>To use the tool fastqc I charged the module <em>fastqc/0.12.1</em> to start the analysis of the quality of the data.</p><p>Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/1%20Introduction/1.1%20What%20is%20FastQC.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/1%20Introduction/1.1%20What%20is%20FastQC.html</a></p><pre class=bash><code>module load fastqc/0.12.1

module list
Currently Loaded Modulefiles:
  1) gcc/5.1.0         2) sge/2011.11p1     3) bcftools/1.10.2   4) fastqc/0.12.1
  </code></pre><p>Once charged the module my next step is used the next command to analyze the quality of the fastq:</p><pre class=bash><code>
fastqc mus_musculus_CEBPA_liver_ERR005132.fastq.gz
</code></pre><p>The output of this comand line is two archives:</p><ul><li>mus_musculus_CEBPA_liver_ERR005132_fastqc.html</li><li>mus_musculus_CEBPA_liver_ERR005132_fastqc.zip</li></ul><p>The first file, redirects you to the results of the analysis performed by this tool, which contains a summary showing which of these filters the fastq managed to pass and which ones did not:</p><p>Summary</p><ul><li>Basic Statistics</li><li>Per base sequence quality</li><li>Per tile sequence quality</li><li>Per sequence quality scores</li><li>Per base sequence content</li><li>Per sequence GC content</li><li>Per base N content</li><li>Sequence Length Distribution</li><li>Sequence Duplication Levels</li><li>Overrepresented sequences</li><li>Adapter Content</li></ul><p>Also each filter of the summary has a graph that shows us more precise and visual the information of the result of this filters.</p><p>In the case of our fastq we have this results:</p><ul><li><em><font color=green>[PASS]</font></em> Basic Statistics</li><li><em><font color=red>[FAIL]</font></em> Per base sequence quality</li><li><em><font color=red>[FAIL]</font></em> Per tile sequence quality</li><li><em><font color=red>[FAIL]</font></em> Per sequence quality scores</li><li><em><font color=red>[FAIL]</font></em> Per base sequence content</li><li><em><font color=green>[PASS]</font></em> Per sequence GC content</li><li><em><font color=green>[PASS]</font></em> Per base N content</li><li><em><font color=green>[PASS]</font></em> Sequence Length Distribution</li><li><em><font color=green>[PASS]</font></em> Sequence Duplication Levels</li><li><em><font color=green>[PASS]</font></em> Overrepresented sequences</li><li><em><font color=green>[PASS]</font></em> Adapter Content</li></ul><p>Now we will analyze the four filters that failed the FASTQC test:</p><p><img src=per_base_quality.png></p><p>This graph shows us the quality scores for the base call. <em><font color=green>Green</font></em> indicates the call has good quality, <em><font color=yellow>yellow</font></em> has reasonable quality, and <em><font color=red>red</font></em> if the quality is very poor.</p><p>In our case we can see that most base calls have low or reasonable quality as they are in the red and yellow part, this helps us conclude that the call quality per base is poor.</p><p>Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/2%20Per%20Base%20Sequence%20Quality.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/2%20Per%20Base%20Sequence%20Quality.html</a></p><p><img src=per_tile_quality.png>
This graph shows quality per tile indicating whether there are variations in quality in different regions of the sequencing process by comparing the sequencing quality at different positions within the read (X) to different tiles in the flow cell (Y) and whether certain tiles (sections of the sequencing machine sensor) produce lower quality data.</p><p>Dark blue tells us that there is high quality in most positions and tiles.
Red/yellow areas show us specific regions with lower quality, which may indicate problems in some tiles in the sequencing flow.</p><p>In the case of our fastq we can see that most tiles and reading positions have a high quality, which is a good sign, but there are some areas with red and yellow dots around positions 12-20 bp and 30-35 bp.
This tells us that in some tiles, the quality is significantly lower at those positions.</p><p>Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/12%20Per%20Tile%20Sequence%20Quality.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/12%20Per%20Tile%20Sequence%20Quality.html</a></p><p><img src=per_sequence_quality.png>
This graph shows us how poorly photographed the sequences are. The X-axis tells us the sequence‚Äôs quality score on the PHRED scale and the Y-axis tells us the number of sequences that contain that score. Our fastq shows that most sequences have an average quality of around 12-15, which means that the accuracy percentage is less than 95%, meaning that the probability of that sequence being correct is low.</p><p>Ref: <a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/3%20Per%20Sequence%20Quality%20Scores.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/3%20Per%20Sequence%20Quality%20Scores.html</a></p><p><img src=per_base_sequence_content.png>
This graph shows the content of each of the nucleotides throughout the read. It is expected that in this graph we can see that the same content of A is equal to the content of T, and in the same way the same content of C must be equal to the content of G. In our case we can observe that at the beginning of the reading the same number of A and T and the same number of C and G are conserved, but from position 20-21 the amount of C deviates and ends up having the same amount of T as C, at the same time in that same position the content of A deviates and ends up having the same amount of A as G. It seems that, halfway through the reading, the amount of purines (A and G) equals each other, as well as the amount of pyrimidines (C and T). The next step would be to investigate what was the cause that caused this error.</p><p>Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/4%20Per%20Base%20Sequence%20Content.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/4%20Per%20Base%20Sequence%20Content.html</a></p><p>In order for our FASTQ file to pass the four filters above, it must be subjected to a filtering process that improves its quality and thus avoids bias in the research.</p><p>The other filters are those that passed the FASTQC test, indicating that:</p><ul><li>It does not have a percentage of N content in all databases.</li></ul><p><img src=per_base_n_content.png>
Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/6%20Per%20Base%20N%20Content.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/6%20Per%20Base%20N%20Content.html</a></p><ul><li>It has sequence fragments of uniform length</li></ul><p><img src=sequence_length_distribution.png>
ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/7%20Sequence%20Length%20Distribution.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/7%20Sequence%20Length%20Distribution.html</a></p><ul><li>It contain a low level of duplication, this can indicate that they have a high level of coverage.</li></ul><p><img src=duplication_levels.png>
Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/8%20Duplicate%20Sequences.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/8%20Duplicate%20Sequences.html</a></p><ul><li>It does not contain overrepresented sequences.</li></ul><p>Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/9%20Overrepresented%20Sequences.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/9%20Overrepresented%20Sequences.html</a>
<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/11%20Kmer%20Content.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/11%20Kmer%20Content.html</a></p><ul><li><p>It does not present this adapter sequences:</p></li><li><p>Illumina Universal Adapter</p></li><li><p>Illumina Small RNA 3‚Äô Adapter</p></li><li><p>Illumina Small RNA 5‚Äô Adapter</p></li><li><p>Nextera Transposase Sequence</p></li><li><p>PolyA</p></li><li><p>PolyG</p></li></ul><p><img src=adapter_content.png>
Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/10%20Adapter%20Content.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/10%20Adapter%20Content.html</a></p><p><strong>Sofi</strong>:</p><p>I started by finding the route in which the mouse genome fasta was allocated (/mnt/Archives/genome/mouse/)mm10/UCSC/bwa-0.7.15-index/index/mm10.fa).</p><p>I just used one command to do the alignment:</p><pre class=bash><code>module load bwa/0.7.8
bwa mem /mnt/Archives/genome/mouse/mm10/UCSC/bwa-0.7.15-index/index/mm10.fa /mnt/atgc-d1/bioinfoII/sgamino/alignment/mus_musculus_CEBPA_liver_ERR005132.fastq.gz &gt; /mnt/atgc-d1/bioinfoII/sgamino/alignment/mouse_align_exp.sam</code></pre><p>This leaves us with a SAM file that will contain the aligned reads to the reference genome mm10.fa. Its important to note that the quality of the fasta is bad, so if we desire more confidence in our alignment we should perform base recalibration to search for possible reads of the adaptors.</p><p>This is the job i submitted with qsub job.sge.</p><pre class=bash><code>#!/bin/bash
# Use current working directory
#$ -cwd
#
# Join stdout and stderr
#$ -j y
#
# Run job through bash shell
#$ -S /bin/bash
#
#You can edit the scriptsince this line
#
# Your job name
#$ -N mouse_align_experiment
#
# Allocated memory
#$ -l vf=30G
# Send an email after the job has finished
#$ -m e
#$ -M ghobibohg@gmail.com
#
# If modules are needed, source modules environment (Do not delete the next line):
. /etc/profile.d/modules.sh
#
# Add any modules you might require:
module load bwa/0.7.8
#
# Write your commands in the next line
bwa mem /mnt/Archives/genome/mouse/mm10/UCSC/bwa-0.7.15-index/index/mm10.fa /mnt/atgc-d1/bioinfoII/sgamino/alignment/mus_musculus_CEBPA_liver_ERR005132.fastq.gz &gt; /mnt/atgc-d1/bioinfoII/sgamino/alignment/mouse_align_exp.sam
</code></pre><blockquote><p>Preview:</p></blockquote><pre class=bash><code>[sgamino@chromatin alignment]$ head -50 mouse_align_exp.sam
@SQ	SN:chr10	LN:130694993
@SQ	SN:chr11	LN:122082543
@SQ	SN:chr12	LN:120129022
@SQ	SN:chr13	LN:120421639
@SQ	SN:chr14	LN:124902244
@SQ	SN:chr15	LN:104043685
@SQ	SN:chr16	LN:98207768
@SQ	SN:chr17	LN:94987271
@SQ	SN:chr18	LN:90702639
@SQ	SN:chr19	LN:61431566
@SQ	SN:chr1	LN:195471971
@SQ	SN:chr2	LN:182113224
@SQ	SN:chr3	LN:160039680
@SQ	SN:chr4	LN:156508116
@SQ	SN:chr5	LN:151834684
@SQ	SN:chr6	LN:149736546
@SQ	SN:chr7	LN:145441459
@SQ	SN:chr8	LN:129401213
@SQ	SN:chr9	LN:124595110
@SQ	SN:chrM	LN:16299
@SQ	SN:chrUn_GL456239	LN:40056
@SQ	SN:chrUn_GL456359	LN:22974
@SQ	SN:chrUn_GL456360	LN:31704
@SQ	SN:chrUn_GL456366	LN:47073
@SQ	SN:chrUn_GL456367	LN:42057
@SQ	SN:chrUn_GL456368	LN:20208
@SQ	SN:chrUn_GL456370	LN:26764
@SQ	SN:chrUn_GL456372	LN:28664
@SQ	SN:chrUn_GL456378	LN:31602
@SQ	SN:chrUn_GL456379	LN:72385
@SQ	SN:chrUn_GL456381	LN:25871
@SQ	SN:chrUn_GL456382	LN:23158
@SQ	SN:chrUn_GL456383	LN:38659
@SQ	SN:chrUn_GL456385	LN:35240
@SQ	SN:chrUn_GL456387	LN:24685
@SQ	SN:chrUn_GL456389	LN:28772
@SQ	SN:chrUn_GL456390	LN:24668
@SQ	SN:chrUn_GL456392	LN:23629
@SQ	SN:chrUn_GL456393	LN:55711
@SQ	SN:chrUn_GL456394	LN:24323
@SQ	SN:chrUn_GL456396	LN:21240
@SQ	SN:chrUn_JH584304	LN:114452
@SQ	SN:chrX	LN:171031299
@SQ	SN:chrY	LN:91744698
@PG	ID:bwa	PN:bwa	VN:0.7.8-r455	CL:bwa mem /mnt/Archives/genome/mouse/mm10/UCSC/bwa-0.7.15-index/index/mm10.fa /mnt/atgc-d1/bioinfoII/sgamino/alignment/mus_musculus_CEBPA_liver_ERR005132.fastq.gz
ERR005132.1	4	*	0	0	*	*	0	0	GATTTACAAGCATATAAACATATAATAAACAACAGCTTTCAT	IIIII/IIIICIIIII45II8*%II)I/+&amp;.%*3II&#39;(C3I#	AS:i:0	XS:i:0
ERR005132.2	4	*	0	0	*	*	0	0	GGTGAAATGACTGAGTCTTCACCCGGTTGGACAGCCCCCCCC	I1I%III9I)D40I&#39;(*,#;*%%03#-0E)=$)HI#%$,&amp;(.	AS:i:0	XS:i:0
ERR005132.3	4	*	0	0	*	*	0	0	AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA	IIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII	AS:i:0	XS:i:0
ERR005132.4	4	*	0	0	*	*	0	0	GATATCGTAATCTGCCAACTGCCATCCCCTCATCTCACACCC	III*7&amp;E.0I%-+:?;C71I&amp;&gt;2:.C$3;//*5/)*,($)=.	AS:i:0	XS:i:0</code></pre><p><strong>UPDATE</strong>:
<strong>Sofia</strong>: Turns out, with the last alignment we had 0.0% of alignments ((T_T)/), so we proceeded to remove adaptors with trimmomatic.</p><p><strong>Ferro</strong>:
We used trimmomatic to be able to remove adapters and process our fastq file.</p><p><strong>Trimmomatic</strong>:
‚ÄúTrimmomatic is a fast, multi-threaded command line tool that can be used to trim Illumina (FASTQ) data and to remove adapters‚Äù (<a href=http://www.usadellab.org class=uri>http://www.usadellab.org</a>)</p><p>This tool has two modes:
For Single-end and Paired-end fastq files</p><p>The Paired-end mode keeps the match of read pairs and uses the additional information in the paired reads to find the adapters or PCR primers.</p><p>Trimmomatic works with fastq files with quality scores phred+33 or phred+64. It accepts files compressed with gzip or bzip2.</p><p>Ref:<a href=http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/TrimmomaticManual_V0.32.pdf class=uri>http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/TrimmomaticManual_V0.32.pdf</a></p><p><strong>Sofia</strong>:
First we loaded the archive which contains the adaptors from illumina, with the name TruSeq3-SE.fa. Its insides are:</p><pre class=bash><code>&gt;TruSeq3_IndexedAdapter
AGATCGGAAGAGCACACGTCTGAACTCCAGTCAC
&gt;TruSeq3_UniversalAdapter
AGATCGGAAGAGCGTCGTGTAGGGAAAGAGTGTA</code></pre><p>Then, we proceeded to run the next command in a job:</p><pre class=bash><code> -threads 4 -phred64 -trimlog /mnt/atgc-d1/bioinfoII/sgamino/alignment/aln_mouse_liver/mus_musculus_CEBPA_liver_ERR005132.trimlog -summary /mnt/atgc-d1/bioinfoII/sgamino/alignment/aln_mouse_liver/TRIM_mus_musculus_CEBPA_liver_ERR005132.summary /mnt/atgc-d1/bioinfoII/sgamino/alignment/mus_musculus_CEBPA_liver_ERR005132.fastq.gz /mnt/atgc-d1/bioinfoII/sgamino/alignment/aln_mouse_liver/TRIM_mus_musculus_CEBPA_liver_ERR005132.fastq.gz ILLUMINACLIP:/mnt/atgc-d1/bioinfoII/sgamino/Adapters/TruSeq3-PE-2.fa:2:30:10 SLIDINGWINDOW:4:25</code></pre><p>This command takes reads with high quality (30) but does NOT has a MINLEN argument to define the minimun lenght of the reads. For that reason, the cut sometimes is very big for the read and we end un with many reads with a lenght of less than 36 bp. In this case we remain with around 10 million reads, with an average lenght of 14 bp.</p><p><strong>Ferro</strong>:
After to use the tool trimming, now we analize the qualification of the new file fastq filtered with the tool <em>fastqc</em>.</p><p>We have these new results for our fastq:
- <em><font color=green>[PASS]</font></em> Basic Statistics
- <em><font color=green>[PASS]</font></em> Per base sequence quality
- <em><font color=green>[PASS]</font></em> Per sequence quality scores
- <em><font color=red>[FAIL]</font></em> Per base sequence content
- <em><font color=green>[PASS]</font></em> Per sequence GC content
- <em><font color=green>[PASS]</font></em> Per base N content
- <em><font color=yellow>[WARN]</font></em> Sequence Length Distribution
- <em><font color=green>[PASS]</font></em> Sequence Duplication Levels
- <em><font color=yellow>[WARN]</font></em> Overrepresented sequences
- <em><font color=green>[PASS]</font></em> Adapter Content</p><p>In contrast to the first graphs of the analysis with fastqc we see that the filters that had not passed already passed after trimmomatic was used.</p><p><img src=per_base_quality_S.png></p><p>In the filter called <em>Quality by base sequence</em> we can see that the average quality of each base in each position of the read is in the green region, which indicates that these positions have good quality. Comparing it with the previous graph, we observe that the quality has increased.</p><p><img src=per_sequence_quality_S.png>
In the case of <em>Per sequence quality scores</em>, with this graph we can confirm that Trimmomatic did filter the minimum size of reads that we asked for, since most of the reads have a size of 36 bp, which was the minimum size we were looking for.</p><p><img src=per_base_sequence_content_S.png>
The case of <em>Per base sequence content</em> Although the new fastq passed this filter, we can see that at the end of the graph the amount of Thymine increases and that of Adenine decreases until having approximately the same amount of Cytosine, in addition to the fact that Cytosine increases and at the end there is a greater amount of Cytosine than its complementary nucleotide, Guanine. It seems that at the end of the graph, the amount of pyrimidine type nucleotides increases. Therefore, even when it passed the filter, there are still different amounts between the complementary nucleotides.</p><p>Finally we got two filters that found an error but not so serious as to fail the test:</p><p><img src=sequence_length_distribution_S.png>
In <em>Sequence length distribution</em> we can also see that the trimming was filtered correctly, since in this graph we can see that most of the samples have a size of 36 bp as requested by the tool, and it also indicates that there are also many 42 bp reads.
This filter can appear in WARM because there may be a wide distribution of lengths, that is, ‚Äúnot all sequences have the same length‚Äù (Babraham Institute), or because the trimming made a cut but not in a uniform way, or because the library is fragmented or due to sequencing errors or if the sequences were trimmed with the adapter..</p><p>Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/7%20Sequence%20Length%20Distribution.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/7%20Sequence%20Length%20Distribution.html</a>
<a href=https://docs.omicsbox.biobam.com/latest/FastQC-Quality-Check/ class=uri>https://docs.omicsbox.biobam.com/latest/FastQC-Quality-Check/</a></p><pre class=bash><code>Sequence	Count	Percentage	Possible Source
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA	922	0.18814713840854458	No Hit</code></pre><p>In <em>Overrepresented sequences</em>It gives us a sequence of 40 adenines, and that this was found 922 times in the data sequence, and represents approximately 0.19% of the total, for this reason, the fastqc tool puts this filter in WARM</p><p>Ref:<a href=https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/9%20Overrepresented%20Sequences.html class=uri>https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/9%20Overrepresented%20Sequences.html</a>
<a href=https://docs.omicsbox.biobam.com/latest/FastQC-Quality-Check/ class=uri>https://docs.omicsbox.biobam.com/latest/FastQC-Quality-Check/</a></p><p><strong>Sofia</strong>:
The code for the alignment is the following:</p><pre class=bash><code>bowtie /mnt/Archives/genome/mouse/mm10/UCSC/bowtie-0.12.7-index/index/mm10 /mnt/atgc-d1/bioinfoII/sgamino/alignment/aln_mouse_liver/TRIM_mus_musculus_CEBPA_liver_ERR005132.fastq 
-S /mnt/atgc-d1/bioinfoII/sgamino/alignment/aln_mouse_liver/TRIM_mus_musculus_CEBPA_liver_ERR005132.sam</code></pre><p>I also performed a trimming but with a MINLEN value of 36, as it is the minimum lenght for an appropiate read. The code used is the following:</p><pre class=bash><code>bowtie /mnt/Archives/genome/mouse/mm10/UCSC/bowtie-0.12.7-index/index/mm10 /mnt/atgc-d1/bioinfoII/sgamino/alignment/aln_mouse_liver/TRIM_minlen36_mus_musculus_CEBPA_liver_ERR005132.fastq 
-S /mnt/atgc-d1/bioinfoII/sgamino/alignment/aln_mouse_liver/TRIM_minlen36_mus_musculus_CEBPA_liver_ERR005132.sam</code></pre><p>And the alignment:</p><pre class=bash><code>bowtie /mnt/Archives/genome/mouse/mm10/UCSC/bowtie-0.12.7-index/index/mm10 /mnt/atgc-d1/bioinfoII/sgamino/alignment/aln_mouse_liver/TRIM_minlen36_mus_musculus_CEBPA_liver_ERR005132.fastq 
-S /mnt/atgc-d1/bioinfoII/sgamino/alignment/aln_mouse_liver/TRIM_minlen36_mus_musculus_CEBPA_liver_ERR005132.sam</code></pre></div></section><footer class=article-footer><section class=article-tags><a href=/tags/bwa/>BWA</a>
<a href=/tags/alignment/>Alignment</a>
<a href=/tags/qc/>QC</a>
<a href=/tags/fastqc/>FASTQC</a>
<a href=/tags/quality-controll/>QUALITY CONTROLL</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0 [This is a lie]</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>Related content</h2><div class=related-content><div class="flex article-list--tile"><article class=has-image><a href=/p/ale_tarea_03/><div class=article-image><img src=/p/ale_tarea_03/covera.d23407b761fb218139d44de8aa61ae08_hu_eecf0331a3900694.jpg width=250 height=150 loading=lazy alt="Featured image of post Genome Browsers" data-key=ale_tarea_03 data-hash="md5-0jQHt2H7IYE51E3oqmGuCA=="></div><div class=article-details><h2 class=article-title>Genome Browsers</h2></div></a></article><article class=has-image><a href=/p/ale_tarea_01/><div class=article-image><img src=/p/ale_tarea_01/cover.54c662af436deae54682166be8b8fb17_hu_d08ec6e54408ce01.jpg width=250 height=150 loading=lazy alt="Featured image of post QC Formats" data-key=ale_tarea_01 data-hash="md5-VMZir0Nt6uVGghZr6Lj7Fw=="></div><div class=article-details><h2 class=article-title>QC Formats</h2></div></a></article><article class=has-image><a href=/p/ale_tarea_06/><div class=article-image><img src=/p/ale_tarea_06/cover.da1e97713fba8bce28f68c49db3a4bf3_hu_9413e49a6ea73382.jpg width=250 height=150 loading=lazy alt="Featured image of post Calidad de transcriptoma" data-key=ale_tarea_06 data-hash="md5-2h6XcT+6i84o9oxJ2zpL8w=="></div><div class=article-details><h2 class=article-title>Calidad de transcriptoma</h2></div></a></article><article class=has-image><a href=/p/ale_tarea_04/><div class=article-image><img src=/covera.jpg loading=lazy data-key=ale_tarea_04 data-hash=/covera.jpg></div><div class=article-details><h2 class=article-title>Visualization 2</h2></div></a></article><article><a href=/p/ale_tarea_05/><div class=article-details><h2 class=article-title>Eleccion de transcriptoma</h2></div></a></article></div></div></aside><div class=disqus-container><div id=disqus_thread></div><script>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//3Codon.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><style>.disqus-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding)}</style><script>window.addEventListener("onColorSchemeChange",e=>{typeof DISQUS=="object"&&DISQUS.reset({reload:!0})})</script><footer class=site-footer><section class=copyright>&copy;
2025 3Codon</section><section class=powerby>Hi, I'm a footer text.<br>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.30.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.1e9a3bafd846ced4c345d084b355fb8c7bae75701c338f8a1f8a82c780137826.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>